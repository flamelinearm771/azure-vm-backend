FROM node:20-slim

WORKDIR /app

# Copy package files
COPY package.json package-lock.json* ./

# Install dependencies
RUN npm install --production --legacy-peer-deps

# Copy application code
COPY server-vm.js ./server.js
COPY blobStorage-vm.js ./blobStorage.js
COPY serviceBus-vm.js ./serviceBus.js
COPY blobResults-vm.js ./blobResults.js

# Set environment variables
ENV NODE_ENV=production
ENV PORT=3000

EXPOSE 3000

CMD ["node", "server.js"]
